"use strict";var G=Object.create;var w=Object.defineProperty;var H=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames,v=Object.getOwnPropertySymbols,Q=Object.getPrototypeOf,$=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var T=(e,r,t)=>r in e?w(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,h=(e,r)=>{for(var t in r||(r={}))$.call(r,t)&&T(e,t,r[t]);if(v)for(var t of v(r))j.call(r,t)&&T(e,t,r[t]);return e};var R=(e,r)=>{var t={};for(var n in e)$.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&v)for(var n of v(e))r.indexOf(n)<0&&j.call(e,n)&&(t[n]=e[n]);return t};var V=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),X=(e,r)=>{for(var t in r)w(e,t,{get:r[t],enumerable:!0})},J=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of F(r))!$.call(e,a)&&a!==t&&w(e,a,{get:()=>r[a],enumerable:!(n=H(r,a))||n.enumerable});return e};var y=(e,r,t)=>(t=e!=null?G(Q(e)):{},J(r||!e||!e.__esModule?w(t,"default",{value:e,enumerable:!0}):t,e)),Y=e=>J(w({},"__esModule",{value:!0}),e);var d=(e,r,t)=>new Promise((n,a)=>{var c=o=>{try{i(t.next(o))}catch(u){a(u)}},s=o=>{try{i(t.throw(o))}catch(u){a(u)}},i=o=>o.done?n(o.value):Promise.resolve(o.value).then(c,s);i((t=t.apply(e,r)).next())});var U=V((re,S)=>{"use strict";function D(){var e=Object.create(null),r=0,t=0,n=0,a=!1;this.put=function(s,i,o,u){if(a&&console.log("caching: %s = %j (@%s)",s,i,o),typeof o!="undefined"&&(typeof o!="number"||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(typeof u!="undefined"&&typeof u!="function")throw new Error("Cache timeout callback must be a function");var l=e[s];l?clearTimeout(l.timeout):n++;var f={value:i,expire:o+Date.now()};return isNaN(f.expire)||(f.timeout=setTimeout(function(){c(s),u&&u(s,i)}.bind(this),o)),e[s]=f,i},this.del=function(s){var i=!0,o=e[s];return o?(clearTimeout(o.timeout),!isNaN(o.expire)&&o.expire<Date.now()&&(i=!1)):i=!1,i&&c(s),i};function c(s){n--,delete e[s]}this.clear=function(){for(var s in e)clearTimeout(e[s].timeout);n=0,e=Object.create(null),a&&(r=0,t=0)},this.get=function(s){var i=e[s];if(typeof i!="undefined"){if(isNaN(i.expire)||i.expire>=Date.now())return a&&r++,i.value;a&&t++,n--,delete e[s]}else a&&t++;return null},this.size=function(){return n},this.memsize=function(){var s=0,i;for(i in e)s++;return s},this.debug=function(s){a=s},this.hits=function(){return r},this.misses=function(){return t},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var s={};for(var i in e){var o=e[i];s[i]={value:o.value,expire:o.expire||"NaN"}}return JSON.stringify(s)},this.importJson=function(s,i){var o=JSON.parse(s),u=Date.now(),l=i&&i.skipDuplicates;for(var f in o)if(o.hasOwnProperty(f)){if(l){var g=e[f];if(g){a&&console.log("Skipping duplicate imported key '%s'",f);continue}}var m=o[f],p=m.expire-u;if(p<=0){this.del(f);continue}p=p>0?p:void 0,this.put(f,m.value,p)}return this.size()}}S.exports=new D;S.exports.Cache=D});var ee={};X(ee,{Languages:()=>B.default,default:()=>Z,translate:()=>M});module.exports=Y(ee);var N=y(require("iso-639-1")),_=y(U());var A={needkey:!0,fetch:({key:e,from:r,to:t,text:n})=>{var a;return[new URL("v2/translate",`https://api${(a=e==null?void 0:e.endsWith)!=null&&a.call(e,":fx")?"-free":""}.deepl.com`),{method:"POST",headers:{Authorization:`DeepL-Auth-Key ${e}`,"Content-Type":"application/json"},body:JSON.stringify(h({text:[n],target_lang:t},r?{source_lang:r}:{}))}]},extraSourceLanguages:[""],parse:e=>d(void 0,null,function*(){if(e.ok)return e.json().then(r=>r.translations[0].text);throw e.status===403?new Error("auth error. check your DeepL API key."):new Error(`error ${e.status}`)})};var C={needkey:!1,fetch:({from:e,to:r,text:t})=>[new URL(`translate_a/single?client=at&sl=${e}&tl=${r}&dt=t&q=${t}`,"https://translate.google.com")],extraSourceLanguages:["auto"],parse:e=>d(void 0,null,function*(){if(!e.ok)throw new Error(`http ${e.status}`);return yield e.json().then(r=>{var a;let t=r,n=((a=t==null?void 0:t[0])==null?void 0:a[0])&&t[0].map(c=>c[0]).join("");if(!n)throw new Error("no response");return n})})},P={needkey:!1,fetch:({from:e,to:r,text:t})=>[new URL("_/TranslateWebserverUi/data/batchexecute","https://translate.google.com"),{method:"POST",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36","Content-Type":"application/x-www-form-urlencoded"},body:`f.req=${JSON.stringify([[["MkEWBc",JSON.stringify([[t,e,r,1],[]]),null,"generic"]]])}`}],extraSourceLanguages:["auto"],parse:e=>d(void 0,null,function*(){if(!e.ok)throw new Error(`http ${e.status}`);return yield e.text().then(r=>{var c,s,i,o,u,l,f;let t=JSON.parse(r.replace(")]}'","").trim()),n=JSON.parse(t[0][2]),a=(f=(l=(u=(o=(i=(s=(c=n==null?void 0:n[1])==null?void 0:c[0])==null?void 0:s[0])==null?void 0:i[5])==null?void 0:o.map)==null?void 0:u.call(o,g=>g[0]))==null?void 0:l.join)==null?void 0:f.call(l,"");if(!a)throw new Error("no response");return a})})},k={needkey:!1,fetch:({from:e,to:r,text:t})=>[new URL(`translate_a/t?client=dict-chrome-ex&sl=${e}&tl=${r}&q=${t}`,"https://clients5.google.com")],extraSourceLanguages:["auto"],parse:e=>d(void 0,null,function*(){if(!e.ok)throw new Error(`http ${e.status}`);return yield e.json().then(r=>{var n;let t=r;if(!((n=t==null?void 0:t[0])!=null&&n[0]))throw new Error("no response");return t[0][0]})})};var z={needkey:!1,fetch:({url:e,key:r,from:t,to:n,text:a})=>[new URL("translate",e||"https://libretranslate.com"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h({q:a,source:t,target:n},r?{api_key:r}:{}))}],extraSourceLanguages:["auto"],parse:e=>e.json().then(r=>{let t=r;if(!(t!=null&&t.translatedText))throw new Error("no response");if(t.error)throw new Error(t.error);return t.translatedText})};var W={needkey:!1,fetch:({url:e,from:r,to:t,text:n})=>[new URL(`api/v1/${r}/${t}/${n}`,e||"https://lingva.ml")],extraSourceLanguages:["auto"],parse:e=>e.json().then(r=>{let t=r;if(!(t!=null&&t.translation))throw new Error("no response");if(t.error)throw new Error(t.error);return t.translation})};var q={needkey:!0,fetch:({key:e,from:r,to:t,text:n})=>[new URL(`api/v1.5/tr.json/translate?key=${e}&lang=${r}-${t}&text=${n}`,"https://translate.yandex.net"),{method:"POST"}],parse:e=>e.json().then(r=>{let t=r;if(t.code!==200)throw new Error(t.message);return t.text[0]})};var I={deepl:A,google:C,google_batchexecute:P,google_dict_chrome_ex:k,libre:z,lingva:W,yandex:q};var B=y(require("iso-639-1"));var M=(e,r)=>d(void 0,null,function*(){var x,O,E,b;let L=h({from:"en",to:"en",engine:"google"},typeof r=="string"?{to:r}:r),{url:t,key:n,cache:a}=L,c=R(L,["url","key","cache"]),s=h(h({},I),c.engines),i=c.engine||"google",o=s[i];if(!o)throw new Error(`invalid engine ${String(i)}`);let u=c.from||typeof c.from=="string"?c.from:"en",l=(((O=(x=o.extraSourceLanguages)==null?void 0:x.includes)==null?void 0:O.call(x,u))||N.default.validate(u))&&u,f=c.to||typeof c.to=="string"?c.to:"en",g=(((b=(E=o.extraTargetLanguages)==null?void 0:E.includes)==null?void 0:b.call(E,f))||N.default.validate(f))&&f;if(typeof l!="string")throw new Error(`unsupported source language "${u}"`);if(typeof g!="string")throw new Error(`unsupported target language "${f}"`);if(l===g)return e;let m=`${t}:${l}:${g}:${String(i)}:${e}`,p=_.default.get(m);if(p)return p;if(o.needkey&&!n)throw new Error(`engine ${String(i)} requires an API key`);return fetch(...o.fetch({from:l,to:g,key:n,url:t,text:e})).then(o.parse).then(K=>_.default.put(m,K,a))}),Z=M;0&&(module.exports={Languages,translate});
