"use strict";var G=Object.create;var w=Object.defineProperty;var H=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames,v=Object.getOwnPropertySymbols,Q=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var T=(e,n,t)=>n in e?w(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,h=(e,n)=>{for(var t in n||(n={}))S.call(n,t)&&T(e,t,n[t]);if(v)for(var t of v(n))j.call(n,t)&&T(e,t,n[t]);return e};var U=(e,n)=>{var t={};for(var r in e)S.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&v)for(var r of v(e))n.indexOf(r)<0&&j.call(e,r)&&(t[r]=e[r]);return t};var V=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports),X=(e,n)=>{for(var t in n)w(e,t,{get:n[t],enumerable:!0})},b=(e,n,t,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let i of F(n))!S.call(e,i)&&i!==t&&w(e,i,{get:()=>n[i],enumerable:!(r=H(n,i))||r.enumerable});return e};var y=(e,n,t)=>(t=e!=null?G(Q(e)):{},b(n||!e||!e.__esModule?w(t,"default",{value:e,enumerable:!0}):t,e)),Y=e=>b(w({},"__esModule",{value:!0}),e);var d=(e,n,t)=>new Promise((r,i)=>{var c=o=>{try{a(t.next(o))}catch(u){i(u)}},s=o=>{try{a(t.throw(o))}catch(u){i(u)}},a=o=>o.done?r(o.value):Promise.resolve(o.value).then(c,s);a((t=t.apply(e,n)).next())});var C=V((ne,$)=>{"use strict";function P(){var e=Object.create(null),n=0,t=0,r=0,i=!1;this.put=function(s,a,o,u){if(i&&console.log("caching: %s = %j (@%s)",s,a,o),typeof o!="undefined"&&(typeof o!="number"||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(typeof u!="undefined"&&typeof u!="function")throw new Error("Cache timeout callback must be a function");var l=e[s];l?clearTimeout(l.timeout):r++;var f={value:a,expire:o+Date.now()};return isNaN(f.expire)||(f.timeout=setTimeout(function(){c(s),u&&u(s,a)}.bind(this),o)),e[s]=f,a},this.del=function(s){var a=!0,o=e[s];return o?(clearTimeout(o.timeout),!isNaN(o.expire)&&o.expire<Date.now()&&(a=!1)):a=!1,a&&c(s),a};function c(s){r--,delete e[s]}this.clear=function(){for(var s in e)clearTimeout(e[s].timeout);r=0,e=Object.create(null),i&&(n=0,t=0)},this.get=function(s){var a=e[s];if(typeof a!="undefined"){if(isNaN(a.expire)||a.expire>=Date.now())return i&&n++,a.value;i&&t++,r--,delete e[s]}else i&&t++;return null},this.size=function(){return r},this.memsize=function(){var s=0,a;for(a in e)s++;return s},this.debug=function(s){i=s},this.hits=function(){return n},this.misses=function(){return t},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var s={};for(var a in e){var o=e[a];s[a]={value:o.value,expire:o.expire||"NaN"}}return JSON.stringify(s)},this.importJson=function(s,a){var o=JSON.parse(s),u=Date.now(),l=a&&a.skipDuplicates;for(var f in o)if(o.hasOwnProperty(f)){if(l){var p=e[f];if(p){i&&console.log("Skipping duplicate imported key '%s'",f);continue}}var m=o[f],g=m.expire-u;if(g<=0){this.del(f);continue}g=g>0?g:void 0,this.put(f,m.value,g)}return this.size()}}$.exports=new P;$.exports.Cache=P});var ee={};X(ee,{Languages:()=>B.default,default:()=>Z,translate:()=>q});module.exports=Y(ee);var L=y(require("iso-639-1")),R=y(C());var J={needkey:!0,fetch:({key:e,from:n,to:t,text:r})=>{var i;return[new URL("v2/translate",`https://api${(i=e==null?void 0:e.endsWith)!=null&&i.call(e,":fx")?"-free":""}.deepl.com`),{method:"POST",headers:{Authorization:`DeepL-Auth-Key ${e}`,"Content-Type":"application/json"},body:JSON.stringify(h({text:[r],target_lang:t},n?{source_lang:n}:{}))}]},extraSourceLanguages:[""],parse:e=>d(void 0,null,function*(){if(e.ok)return e.json().then(n=>n.translations[0].text);throw e.status===403?new Error("auth error. check your DeepL API key."):new Error(`error ${e.status}`)})};var A={needkey:!1,fetch:({from:e,to:n,text:t})=>[new URL(`translate_a/single?${new URLSearchParams({client:"at",sl:e,tl:n,dt:"t",q:t})}`,"https://translate.google.com")],extraSourceLanguages:["auto"],parse:e=>d(void 0,null,function*(){if(!e.ok)throw new Error(`http ${e.status}`);return yield e.json().then(n=>{var i;let t=n,r=((i=t==null?void 0:t[0])==null?void 0:i[0])&&t[0].map(c=>c[0]).join("");if(!r)throw new Error("no response");return r})})},D={needkey:!1,fetch:({from:e,to:n,text:t})=>[new URL("_/TranslateWebserverUi/data/batchexecute","https://translate.google.com"),{method:"POST",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36","Content-Type":"application/x-www-form-urlencoded"},body:`f.req=${JSON.stringify([[["MkEWBc",JSON.stringify([[t,e,n,1],[]]),null,"generic"]]])}`}],extraSourceLanguages:["auto"],parse:e=>d(void 0,null,function*(){if(!e.ok)throw new Error(`http ${e.status}`);return yield e.text().then(n=>{var c,s,a,o,u,l,f;let t=JSON.parse(n.replace(")]}'","").trim()),r=JSON.parse(t[0][2]),i=(f=(l=(u=(o=(a=(s=(c=r==null?void 0:r[1])==null?void 0:c[0])==null?void 0:s[0])==null?void 0:a[5])==null?void 0:o.map)==null?void 0:u.call(o,p=>p[0]))==null?void 0:l.join)==null?void 0:f.call(l,"");if(!i)throw new Error("no response");return i})})},k={needkey:!1,fetch:({from:e,to:n,text:t})=>[new URL(`translate_a/t?${new URLSearchParams({client:"dict-chrome-ex",sl:e,tl:n,q:t})}`,"https://clients5.google.com")],extraSourceLanguages:["auto"],parse:e=>d(void 0,null,function*(){if(!e.ok)throw new Error(`http ${e.status}`);return yield e.json().then(n=>{var r;let t=n;if(!((r=t==null?void 0:t[0])!=null&&r[0]))throw new Error("no response");return t[0][0]})})};var z={needkey:!1,fetch:({url:e,key:n,from:t,to:r,text:i})=>[new URL("translate",e||"https://libretranslate.com"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h({q:i,source:t,target:r},n?{api_key:n}:{}))}],extraSourceLanguages:["auto"],parse:e=>e.json().then(n=>{let t=n;if(!(t!=null&&t.translatedText))throw new Error("no response");if(t.error)throw new Error(t.error);return t.translatedText})};var I={needkey:!1,fetch:({url:e,from:n,to:t,text:r})=>[new URL(`api/v1/${encodeURIComponent(n)}/${encodeURIComponent(t)}/${encodeURIComponent(r)}`,e||"https://lingva.ml")],extraSourceLanguages:["auto"],parse:e=>e.json().then(n=>{let t=n;if(!(t!=null&&t.translation))throw new Error("no response");if(t.error)throw new Error(t.error);return t.translation})};var W={needkey:!0,fetch:({key:e,from:n,to:t,text:r})=>[new URL(`api/v1.5/tr.json/translate?${new URLSearchParams({key:e,lang:`${n}-${t}`,text:r})}`,"https://translate.yandex.net"),{method:"POST"}],parse:e=>e.json().then(n=>{let t=n;if(t.code!==200)throw new Error(t.message);return t.text[0]})};var M={deepl:J,google:A,google_batchexecute:D,google_dict_chrome_ex:k,libre:z,lingva:I,yandex:W};var B=y(require("iso-639-1"));var q=(e,n)=>d(void 0,null,function*(){var x,N,E,O;let _=h({from:"en",to:"en",engine:"google"},n),{url:t,key:r,cache:i}=_,c=U(_,["url","key","cache"]),s=h(h({},M),c.engines),a=c.engine||"google",o=s[a];if(!o)throw new Error(`invalid engine ${String(a)}`);let u=c.from||typeof c.from=="string"?c.from:"en",l=(((N=(x=o.extraSourceLanguages)==null?void 0:x.includes)==null?void 0:N.call(x,u))||L.default.validate(u))&&u,f=c.to||typeof c.to=="string"?c.to:"en",p=(((O=(E=o.extraTargetLanguages)==null?void 0:E.includes)==null?void 0:O.call(E,f))||L.default.validate(f))&&f;if(typeof l!="string")throw new Error(`unsupported source language "${u}"`);if(typeof p!="string")throw new Error(`unsupported target language "${f}"`);if(l===p)return e;let m=`${t}:${l}:${p}:${String(a)}:${e}`,g=R.default.get(m);if(g)return g;if(o.needkey&&!r)throw new Error(`engine ${String(a)} requires an API key`);return fetch(...o.fetch({from:l,to:p,key:r,url:t,text:e})).then(o.parse).then(K=>R.default.put(m,K,i))}),Z=q;0&&(module.exports={Languages,translate});
