"use strict";var F=Object.create;var m=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var H=Object.getOwnPropertyNames,v=Object.getOwnPropertySymbols,M=Object.getPrototypeOf,$=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var T=(e,r,t)=>r in e?m(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,l=(e,r)=>{for(var t in r||(r={}))$.call(r,t)&&T(e,t,r[t]);if(v)for(var t of v(r))R.call(r,t)&&T(e,t,r[t]);return e};var _=(e,r)=>{var t={};for(var n in e)$.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&v)for(var n of v(e))r.indexOf(n)<0&&R.call(e,n)&&(t[n]=e[n]);return t};var Q=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),V=(e,r)=>{for(var t in r)m(e,t,{get:r[t],enumerable:!0})},D=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of H(r))!$.call(e,a)&&a!==t&&m(e,a,{get:()=>r[a],enumerable:!(n=G(r,a))||n.enumerable});return e};var y=(e,r,t)=>(t=e!=null?F(M(e)):{},D(r||!e||!e.__esModule?m(t,"default",{value:e,enumerable:!0}):t,e)),X=e=>D(m({},"__esModule",{value:!0}),e);var E=(e,r,t)=>new Promise((n,a)=>{var f=o=>{try{i(t.next(o))}catch(u){a(u)}},s=o=>{try{i(t.throw(o))}catch(u){a(u)}},i=o=>o.done?n(o.value):Promise.resolve(o.value).then(f,s);i((t=t.apply(e,r)).next())});var P=Q((ee,S)=>{"use strict";function J(){var e=Object.create(null),r=0,t=0,n=0,a=!1;this.put=function(s,i,o,u){if(a&&console.log("caching: %s = %j (@%s)",s,i,o),typeof o!="undefined"&&(typeof o!="number"||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(typeof u!="undefined"&&typeof u!="function")throw new Error("Cache timeout callback must be a function");var p=e[s];p?clearTimeout(p.timeout):n++;var c={value:i,expire:o+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){f(s),u&&u(s,i)}.bind(this),o)),e[s]=c,i},this.del=function(s){var i=!0,o=e[s];return o?(clearTimeout(o.timeout),!isNaN(o.expire)&&o.expire<Date.now()&&(i=!1)):i=!1,i&&f(s),i};function f(s){n--,delete e[s]}this.clear=function(){for(var s in e)clearTimeout(e[s].timeout);n=0,e=Object.create(null),a&&(r=0,t=0)},this.get=function(s){var i=e[s];if(typeof i!="undefined"){if(isNaN(i.expire)||i.expire>=Date.now())return a&&r++,i.value;a&&t++,n--,delete e[s]}else a&&t++;return null},this.size=function(){return n},this.memsize=function(){var s=0,i;for(i in e)s++;return s},this.debug=function(s){a=s},this.hits=function(){return r},this.misses=function(){return t},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var s={};for(var i in e){var o=e[i];s[i]={value:o.value,expire:o.expire||"NaN"}}return JSON.stringify(s)},this.importJson=function(s,i){var o=JSON.parse(s),u=Date.now(),p=i&&i.skipDuplicates;for(var c in o)if(o.hasOwnProperty(c)){if(p){var h=e[c];if(h){a&&console.log("Skipping duplicate imported key '%s'",c);continue}}var d=o[c],g=d.expire-u;if(g<=0){this.del(c);continue}g=g>0?g:void 0,this.put(c,d.value,g)}return this.size()}}S.exports=new J;S.exports.Cache=J});var Z={};V(Z,{Languages:()=>W.default,default:()=>Y,translate:()=>K});module.exports=X(Z);var N=y(require("iso-639-1")),L=y(P());var z={needkey:!0,fetch:({key:e,from:r,to:t,text:n})=>{var a;return[new URL("v2/translate",`https://api${(a=e==null?void 0:e.endsWith)!=null&&a.call(e,":fx")?"-free":""}.deepl.com`),{method:"POST",headers:{Authorization:`DeepL-Auth-Key ${e}`,"Content-Type":"application/json"},body:JSON.stringify(l({text:[n],target_lang:t},r?{source_lang:r}:{}))}]},extraSourceLanguages:[""],parse:e=>E(void 0,null,function*(){if(e.ok)return e.json().then(r=>r.translations[0].text);throw e.status===403?new Error("auth error. check your DeepL API key."):new Error(`error ${e.status}`)})};var C={needkey:!1,fetch:({from:e,to:r,text:t})=>[new URL(`translate_a/single?client=at&sl=${e}&tl=${r}&dt=t&q=${t}`,"https://translate.google.com")],extraSourceLanguages:["auto"],parse:e=>e.json().then(r=>{var a;let t=r,n=((a=t==null?void 0:t[0])==null?void 0:a[0])&&t[0].map(f=>f[0]).join("");if(!n)throw new Error("translation not found");return n})};var A={needkey:!1,fetch:({url:e,key:r,from:t,to:n,text:a})=>[new URL("translate",e||"https://libretranslate.com"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l({q:a,source:t,target:n},r?{api_key:r}:{}))}],extraSourceLanguages:["auto"],parse:e=>e.json().then(r=>{let t=r;if(!(t!=null&&t.translatedText))throw new Error("no response");if(t.error)throw new Error(t.error);return t.translatedText})};var U={needkey:!1,fetch:({url:e,from:r,to:t,text:n})=>[new URL(`api/v1/${r}/${t}/${n}`,e||"https://lingva.ml")],extraSourceLanguages:["auto"],parse:e=>e.json().then(r=>{let t=r;if(!(t!=null&&t.translation))throw new Error("no response");if(t.error)throw new Error(t.error);return t.translation})};var I={needkey:!0,fetch:({key:e,from:r,to:t,text:n})=>[new URL(`api/v1.5/tr.json/translate?key=${e}&lang=${r}-${t}&text=${n}`,"https://translate.yandex.net"),{method:"POST"}],parse:e=>e.json().then(r=>{let t=r;if(t.code!==200)throw new Error(t.message);return t.text[0]})};var q={deepl:z,google:C,libre:A,lingva:U,yandex:I};var W=y(require("iso-639-1"));var K=(e,r)=>E(void 0,null,function*(){var w,j,x,b;let O=l({from:"en",to:"en",engine:"google"},typeof r=="string"?{to:r}:r),{url:t,key:n,cache:a}=O,f=_(O,["url","key","cache"]),s=l(l({},q),f.engines),i=f.engine||"google",o=s[i];if(!o)throw new Error(`invalid engine ${String(i)}`);let u=f.from||typeof f.from=="string"?f.from:"en",p=(((j=(w=o.extraSourceLanguages)==null?void 0:w.includes)==null?void 0:j.call(w,u))||N.default.validate(u))&&u,c=f.to||typeof f.to=="string"?f.to:"en",h=(((b=(x=o.extraTargetLanguages)==null?void 0:x.includes)==null?void 0:b.call(x,c))||N.default.validate(c))&&c;if(typeof p!="string")throw new Error(`unsupported source language "${u}"`);if(typeof h!="string")throw new Error(`unsupported target language "${c}"`);if(p===h)return e;let d=`${t}:${p}:${h}:${String(i)}:${e}`,g=L.default.get(d);if(g)return g;if(o.needkey&&!n)throw new Error(`engine ${String(i)} requires an API key`);return fetch(...o.fetch({from:p,to:h,key:n,url:t,text:e})).then(o.parse).then(B=>L.default.put(d,B,a))}),Y=K;0&&(module.exports={Languages,translate});
